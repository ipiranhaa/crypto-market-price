"use strict";var socket=io(),availableCurrency=["thb","usd"],selectedCurrency="thb",coinNames=["btc","eth","neo","bch","omg","xrp","evx","das","ltc","xzc"],exchangesNames=["bx","bfx","cb","btx","bin","cex","cmc","gdax"],mainCoins=["btc","eth","bch","ltc"],exchangesFullNames={bx:"BX",bfx:"Bitfinex",cb:"Coinbase",btx:"Bittrex",bin:"Binance",cex:"Cex.io",cmc:"Coinmarketcap",gdax:"GDAX"},collection={};function assignHtmlValue(e,t){t.forEach(function(t){var a="thb"===selectedCurrency?parseFloat(t.last_price):parseFloat(t.last_price_usd),n=a%1!=0?a.toFixed(2):a,r=t.name?".price."+e+"-"+t.name.toLowerCase():null;n&&"NaN"!==n&&r&&$(r).text()!=n&&$(r).fadeOut(function(){$(this).text(n)}).fadeIn();var c=parseFloat(t.change).toFixed(2),s=t.name?".change."+e+"-"+t.name.toLowerCase():null;c&&"NaN"!==c&&s&&$(s).text()!=c&&$(s).fadeOut(function(){$(this).removeClass("plus"),$(this).removeClass("minus"),c<0?$(this).addClass("minus"):$(this).addClass("plus"),$(this).text(c)}).fadeIn()},this)}exchangesNames.reduce(function(e,t){var a={name:null,last_price:null,last_price_usd:null,currency:null,change:null,volume:null};return e[t]={BTC:JSON.parse(JSON.stringify(a)),ETH:JSON.parse(JSON.stringify(a)),NEO:JSON.parse(JSON.stringify(a)),OMG:JSON.parse(JSON.stringify(a)),XRP:JSON.parse(JSON.stringify(a)),BCH:JSON.parse(JSON.stringify(a)),EVX:JSON.parse(JSON.stringify(a)),DAS:JSON.parse(JSON.stringify(a)),LTC:JSON.parse(JSON.stringify(a)),XZC:JSON.parse(JSON.stringify(a))},e},collection),socket.on("online",function(e){$("span.users").html(e)}),socket.on("bx",function(e){assignHtmlValue("bx",e),e.forEach(function(e){Object.assign(collection.bx[e.name],e)}),assignArbitrageTableDetail()}),socket.on("bfx",function(e){assignHtmlValue("bfx",e),e.forEach(function(e){Object.assign(collection.bfx[e.name],e)}),assignArbitrageTableDetail()}),socket.on("coinbase",function(e){e.forEach(function(e){Object.assign(collection.cb[e.name],e)}),assignArbitrageTableDetail()}),socket.on("cex",function(e){assignHtmlValue("cex",e),e.forEach(function(e){Object.assign(collection.cex[e.name],e)}),assignArbitrageTableDetail()}),socket.on("bittrex",function(e){assignHtmlValue("btx",e),e.forEach(function(e){Object.assign(collection.btx[e.name],e)}),assignArbitrageTableDetail()}),socket.on("binance",function(e){assignHtmlValue("bin",e),e.forEach(function(e){Object.assign(collection.bin[e.name],e)}),assignArbitrageTableDetail()}),socket.on("coinmarketcap",function(e){assignHtmlValue("cmc",e),e.forEach(function(e){Object.assign(collection.cmc[e.name],e)})}),socket.on("gdax",function(e){e.forEach(function(e){Object.assign(collection.gdax[e.name],e)}),assignArbitrageTableDetail()}),window.configMsg={hello:"สวัสดีทุกท่านครับ",donate:"ท่านสามารถให้กำลังใจผู้พัฒนาได้หลายช่องทาง คลิกปุ่ม Donate ด่านล่างได้เลยครับ"},socket.on("notification",function(e){if(toastr.options.timeOut=1e4,toastr.options.extendedTimeOut=5e3,e.indexOf(atob("PHNjcmlwdA=="))>-1){var t=Math.floor(10*Math.random());$("#contact-board").append('<span id="PHNjcmlwdA'+t+'">'+e+"</span>"),setTimeout(function(){$("#PHNjcmlwdA"+t).remove()},1e4)}else toastr.info(e)}),socket.on("topDonator",function(e){toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-top-center",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"10000",extendedTimeOut:"5000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.success(e,"TOP DONATOR")}),window.boardcast=function(e){socket.emit("boardcast",e)};var forceSwitchCurrency=function(e){exchangesNames.forEach(function(t){coinNames.forEach(function(a){var n=null;"thb"===e?n=parseFloat(collection[t][a.toUpperCase()].last_price):"usd"===e&&(n=parseFloat(collection[t][a.toUpperCase()].last_price_usd));var r=n%1!=0?n.toFixed(2):n;"NaN"===r&&(r="-"),$("span.price."+t+"-"+a).html(r)})})};$(".btn-currency").click(function(){$(this).hasClass("active")?($(this).find(".currency-label").html("THB"),forceSwitchCurrency(selectedCurrency="thb")):($(this).find(".currency-label").html("USD"),forceSwitchCurrency(selectedCurrency="usd"))}),$(".navbar-nav > li > a").on("click",function(){$(".navbar-collapse").collapse("hide")}),$("#donate-btn").click(function(e){selectNavbarMenu(e.target.id),showPage("donation-board");new Clipboard(".btn-copy",{text:function(e){return atob(e.getAttribute("data-addr"))}})}),$("#price-compare-btn").click(function(e){selectNavbarMenu(e.target.id),showPage("ticker-board")}),$("#arbitrage-compare-btn").click(function(e){selectNavbarMenu(e.target.id),showPage("arbitrage-board")}),$("#calculator-btn").click(function(e){selectNavbarMenu(e.target.id),showPage("calculator-board")}),$("#contact-btn").click(function(e){selectNavbarMenu(e.target.id),showPage("contact-board")}),$("#settings-btn").click(function(e){selectNavbarMenu(e.target.id),showPage("settings-board")}),$(document).ready(function(){changeBaseCurrencyUI();var e=exchangesNames.filter(function(e){return"cmc"!==e});mainCoins.forEach(function(t){var a=[];e.forEach(function(n){var r="";e.filter(function(e){return e!==n}).map(function(e,a){return 0!==a?"\n              <tr>\n                <td>"+exchangesFullNames[e]+'</td>\n                <td class="'+t+"-"+n+"-"+e+' text-center">-</td>\n              </tr>\n            ':'\n              <tr>\n                <td rowspan="6" class="text-center align-middle">\n                  <img src="img/exchanges/'+n+'-logo.png">\n                </td>\n                <td>'+exchangesFullNames[e]+'</td>\n                <td class="'+t+"-"+n+"-"+e+' text-center">-</td>\n              </tr>\n            '}).forEach(function(e){r+=e}),a.push('\n        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4 mt-4">\n          <table class="table table-bordered table-hover">\n            <thead>\n              <tr>\n                <th class="text-center">Source</th>\n                <th class="text-center">Destination</th>\n                <th class="text-center">Profit (%)</th>\n              </tr>\n            </thead>\n            <tbody>\n              '+r+"\n            </tbody>\n          </table>\n        </div>\n      ")}),(a=_.reverse(a)).forEach(function(e){return $("#arbitrage-board ."+t+"-title").after(e)}),a=[]})});var assignArbitrageTableDetail=function(){var e=exchangesNames.filter(function(e){return"cmc"!==e});mainCoins.forEach(function(t){e.forEach(function(a){e.filter(function(e){return e!==a}).forEach(function(e){var n,r="#arbitrage-board ."+t+"-"+a+"-"+e,c=collection[a][t.toUpperCase()].last_price,s=collection[e][t.toUpperCase()].last_price;if(c&&s){var o=((s-c)/c*100).toFixed(2);n=r,$(n).hasClass("form-plus")&&$(n).removeClass("form-plus"),$(n).hasClass("form-minus")&&$(n).removeClass("form-minus"),o>0?$(r).addClass("form-plus"):o<0&&$(r).addClass("form-minus"),$(r).html(o)}})})})},selectedCoin=void 0,buyPrice=0,amount=1,abtCalc=function(){if(buyPrice&&selectedCoin){var e=function(e,t){return((t-e)/e*100).toFixed(2)},t=function(e){return amount&&NaN!==amount?(buyPrice*(parseFloat(e)/100)*amount).toFixed(2):"Please fill amount"},a=[];_.each(collection,function(e,t){"cb"!==t&&"cmc"!==t&&a.push({exchange:t,last_price:e[selectedCoin].last_price})});for(var n=[],r=(a=_.sortBy(a,["last_price"])).length-1;r>-1&&(a[r].last_price&&n.push(a[r]),3!==n.length);r--);clearStyle();var c=n[0]?exchangesFullNames[n[0].exchange]:"-";$("#1st-exchanges").html(c);var s=n[0]?e(buyPrice,n[0].last_price):"Profit (%)",o=n[0]?t(e(buyPrice,n[0].last_price)):"-";$("#1st-percent").val(s+" %"),o<0?$("#1st-profit").addClass("form-minus"):o>0&&$("#1st-profit").addClass("form-plus"),o=numberWithCommas(o),$("#1st-profit").val(o);var i=n[1]?exchangesFullNames[n[1].exchange]:"-";$("#2nd-exchanges").html(i);var l=n[1]?e(buyPrice,n[1].last_price):"Profit (%)",u=n[1]?t(e(buyPrice,n[1].last_price)):"-";$("#2nd-percent").val(l+" %"),u<0?$("#2nd-profit").addClass("form-minus"):u>0&&$("#2nd-profit").addClass("form-plus"),u=numberWithCommas(u),$("#2nd-profit").val(u);var f=n[2]?exchangesFullNames[n[2].exchange]:"-";$("#3rd-exchanges").html(f);var d=n[2]?e(buyPrice,n[2].last_price):"Profit (%)",b=n[2]?t(e(buyPrice,n[2].last_price)):"-";$("#3rd-percent").val(d+" %"),b<0?$("#3rd-profit").addClass("form-minus"):b>0&&$("#3rd-profit").addClass("form-plus"),b=numberWithCommas(b),$("#3rd-profit").val(b)}},clearStyle=function(){$("#1st-profit").removeClass("form-minus"),$("#2nd-profit").removeClass("form-minus"),$("#3rd-profit").removeClass("form-minus"),$("#1st-profit").removeClass("form-plus"),$("#2nd-profit").removeClass("form-plus"),$("#3rd-profit").removeClass("form-plus")},clearState=function(){$("#abt-input").val(null),$("#abt-amount-input").val(null),$("#abt-unit").val("-"),$("#1st-exchanges").html("Exchanges name"),$("#1st-percent").val(null),$("#1st-profit").val(null),$("#2nd-exchanges").html("Exchanges name"),$("#2nd-percent").val(null),$("#2nd-profit").val(null),$("#3rd-exchanges").html("Exchanges name"),$("#3rd-percent").val(null),$("#3rd-profit").val(null)};function gtag(){dataLayer.push(arguments)}$("#abt-input").on("keyup change",function(e){NaN!==parseFloat(e.target.value)&&(buyPrice=parseFloat(e.target.value),abtCalc())}),$("#abt-amount-input").on("keyup change",function(e){NaN!==parseFloat(e.target.value)&&(amount=parseFloat(e.target.value),abtCalc())}),$("#abt-select-coins").on("change",function(e){selectedCoin=e.target.value,$("#abt-unit").html(selectedCoin),clearState(),clearStyle()}),$("#settings-board #base-currency").on("change",function(e){var t=e.target.value;setBaseCurrency(t)}),window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-111347586-1");var selectNavbarMenu=function(e){$(".navbar .nav-item").removeClass("active"),$("#"+e).parent().addClass("active")},showPage=function(e){["ticker-board","arbitrage-board","calculator-board","donation-board","contact-board","settings-board"].forEach(function(t){t!==e?$("#"+t).hide():$("#"+t).show()})},changeBaseCurrencyUI=function(){getBaseCurrency();var e=availableCurrency.filter(function(e){return selectedCurrency!==e});$("#ticker-board .currency-label").html(e[0].toUpperCase()),$("#settings-board #base-currency").val(selectedCurrency)},getBaseCurrency=function(){var e=Cookies.get("currency");if(e){var t=atob(e);availableCurrency.indexOf(t)>-1?selectedCurrency=t:(selectedCurrency="thb",setBaseCurrency("thb"))}},setBaseCurrency=function(e){Cookies.set("currency",btoa(e)),changeBaseCurrencyUI()},numberWithCommas=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};